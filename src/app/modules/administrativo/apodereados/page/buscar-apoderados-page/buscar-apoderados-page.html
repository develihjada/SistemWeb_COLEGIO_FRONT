<!-- Modal de búsqueda centrado -->
<div class="search-modal-backdrop" (click)="onBackdropClick($event)">
  <div class="search-modal-container" (click)="$event.stopPropagation()">

    <!-- Header del modal -->
    <div class="search-modal-header">
      <h4 class="search-modal-title">
        <i class="ti ti-search me-2"></i>
        Buscar Apoderados
      </h4>
      <button class="search-modal-close" (click)="closeSearch()">
        <i class="ti ti-x"></i>
      </button>
    </div>

    <!-- Input de búsqueda -->
    <div class="search-input-container">
      <div class="search-input-wrapper">
        <i class="ti ti-search search-input-icon"></i>
        <input
          type="text"
          class="search-input"
          placeholder="Buscar por nombre, DNI, teléfono, correo..."
          [(ngModel)]="searchTerm"
          (input)="onSearchChange()"
          #searchInput
          autofocus>
        <button
          *ngIf="searchTerm"
          class="search-clear-btn"
          (click)="closeSearch()">
          <i class="ti ti-x"></i>
        </button>
      </div>
    </div>

    <!-- Indicador de búsqueda vacía -->
    <div *ngIf="!isSearching && searchTerm.length === 0" class="search-empty-state">
      <i class="ti ti-search search-empty-icon"></i>
      <p class="search-empty-text">Comienza escribiendo para buscar apoderados</p>
      <small class="search-empty-hint">Puedes buscar por nombre, DNI, teléfono o correo</small>
    </div>

    <!-- Resultados de búsqueda -->
    <div *ngIf="isSearching" class="search-results-container">

      <!-- Mensaje de "buscando" -->
      <div *ngIf="searchTerm.length > 0 && searchTerm.length < 2" class="search-hint">
        <i class="ti ti-edit search-hint-icon"></i>
        <span>Escribe al menos 2 caracteres para buscar</span>
      </div>

      <!-- Sin resultados -->
      <div *ngIf="searchTerm.length >= 2 && searchResults.length === 0" class="search-no-results">
        <i class="ti ti-mood-sad search-no-results-icon"></i>
        <p class="search-no-results-text">No se encontraron resultados</p>
        <small class="search-no-results-hint">Intenta con otros términos de búsqueda</small>
      </div>

      <!-- Lista de resultados -->
      <div *ngIf="searchResults.length > 0" class="search-results-list">
        <div class="search-results-header">
          <span class="search-results-count">
            <i class="ti ti-users me-1"></i>
            {{ searchResults.length }} resultado{{ searchResults.length === 1 ? '' : 's' }} encontrado{{ searchResults.length === 1 ? '' : 's' }}
          </span>
        </div>

        <div class="search-results-items">
          <div
            *ngFor="let apoderado of searchResults; trackBy: trackByApoderado"
            class="search-result-item"
            (click)="selectApoderado(apoderado)">

            <div class="search-result-avatar">
              <i class="ti ti-user"></i>
            </div>

            <div class="search-result-info">
              <div class="search-result-name">{{ apoderado.nombre }}</div>
              <div class="search-result-details">
                <span class="search-result-detail">
                  <i class="ti ti-id me-1"></i>DNI: {{ apoderado.dni }}
                </span>
                <span class="search-result-detail">
                  <i class="ti ti-phone me-1"></i>{{ apoderado.telefono }}
                </span>
              </div>
              <div class="search-result-email">
                <i class="ti ti-mail me-1"></i>{{ apoderado.correo }}
              </div>
            </div>

            <div class="search-result-type">
              <span class="search-result-badge" [ngClass]="{
                'badge-padre': apoderado.tipo === 'Padre',
                'badge-madre': apoderado.tipo === 'Madre',
                'badge-tutor': apoderado.tipo === 'Tutor'
              }">
                <i class="ti" [ngClass]="{
                  'ti-user': apoderado.tipo === 'Padre',
                  'ti-user-heart': apoderado.tipo === 'Madre',
                  'ti-shield': apoderado.tipo === 'Tutor'
                }"></i>
                {{ apoderado.tipo }}
              </span>
            </div>

            <div class="search-result-arrow">
              <i class="ti ti-chevron-right"></i>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer con shortcuts -->
    <div class="search-modal-footer">
      <div class="search-shortcuts">
        <span class="search-shortcut">
          <kbd>ESC</kbd> Cerrar
        </span>
        <span class="search-shortcut">
          <kbd>↑</kbd><kbd>↓</kbd> Navegar
        </span>
        <span class="search-shortcut">
          <kbd>Enter</kbd> Seleccionar
        </span>
      </div>
    </div>

  </div>
</div>
